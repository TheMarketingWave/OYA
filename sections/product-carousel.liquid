{% style %}
  #shopify-section-{{ section.id }} {
    background-color: var(--color-brand-{{ section.settings.background_color }});
  }
{% endstyle %}

<section
  class="product-carousel section-container"
>
  <div class="product-carousel__header">
    <div class="product-carousel__header-content">
      {% if section.settings.title != blank %}
        <h2 class="product-carousel__title title-font">{{ section.settings.title }}</h2>
      {% endif %}

      {% if section.settings.subtitle != blank %}
        <p class="product-carousel__subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}
    </div>

    <div class="product-carousel__navigation">
      <button type="button" class="product-carousel__nav-button" id="carousel-prev-btn" aria-label="Previous products">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
          <mask id="mask0_490_462" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="20" height="20">
            <rect width="20" height="20" fill="#D9D9D9"/>
          </mask>
          <g mask="url(#mask0_490_462)">
            <path d="M11.6667 15L6.66669 10L11.6667 5L12.8334 6.16667L9.00002 10L12.8334 13.8333L11.6667 15Z" fill="#E0D9BA"/>
          </g>
        </svg>
      </button>
      <button type="button" class="product-carousel__nav-button" id="carousel-next-btn" aria-label="Next products">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
          <mask id="mask0_490_152" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="20" height="20">
            <rect width="20" height="20" fill="#D9D9D9"/>
          </mask>
          <g mask="url(#mask0_490_152)">
            <path d="M10.5 10L6.66669 6.16667L7.83335 5L12.8334 10L7.83335 15L6.66669 13.8333L10.5 10Z" fill="#E0D9BA"/>
          </g>
        </svg>
      </button>
    </div>
  </div>

  <div class="product-carousel__track">
    {% if section.blocks.size > 0 %}
      {% for block in section.blocks %}
        {% if block.settings.product != blank %}
          {% assign product = all_products[block.settings.product] %}
          {% render 'product-card-enhanced', product: product %}
        {% endif %}
      {% endfor %}
    {% else %}
      <!-- Placeholder cards when no products are selected -->
      {% for i in (1..4) %}
        <div class="product-card">
          <div
            class="product-card__image"
            style="background: #f0f0f0; display: flex; align-items: center; justify-content: center; color: #999;"
          >
            Product Image
          </div>
          <div class="product-card__tags">
            <span class="product-card__tag">Sample Tag</span>
          </div>
          <h3 class="product-card__title">Sample Product {{ i }}</h3>
          <p class="product-card__description">
            This is a sample product description. Add products using the blocks below.
          </p>
          <div class="product-card__details">
            <span class="product-card__price">$29.99</span>
            <span class="product-card__weight">50ml</span>
          </div>
          <button class="product-card__button">Add to Cart</button>
        </div>
      {% endfor %}
    {% endif %}
  </div>

  {% if section.settings.cta_text != blank and section.settings.cta_url != blank %}
    <div class="product-carousel__cta">
      {% render 'icon-button', url: section.settings.cta_url, label: section.settings.cta_text, icon: 'bottle.svg' %}
    </div>
  {% endif %}
</section>

{% schema %}
{
  "name": "Product Carousel",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Section Content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Featured Products"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Discover our handcrafted collection"
    },
    {
      "type": "header",
      "content": "Call to Action"
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Button Text",
      "default": "View All Products"
    },
    {
      "type": "url",
      "id": "cta_url",
      "label": "CTA Button URL"
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Background Color",
      "default": "brown",
      "options": [
        {
          "value": "brown",
          "label": "Dark Brown (#1f1518)"
        },
        {
          "value": "brown2",
          "label": "Medium Brown (#291c1f)"
        },
        {
          "value": "cream",
          "label": "Cream (#e0d9ba)"
        },
        {
          "value": "green",
          "label": "Green (#587a4f)"
        }
      ]
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Carousel",
      "blocks": [
        {
          "type": "product"
        },
        {
          "type": "product"
        },
        {
          "type": "product"
        },
        {
          "type": "product"
        }
      ]
    }
  ]
}
{% endschema %}
